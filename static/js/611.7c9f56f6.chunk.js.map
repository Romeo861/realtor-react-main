{"version":3,"file":"static/js/611.7c9f56f6.chunk.js","mappings":"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","sources":["pages/Profile.jsx"],"sourcesContent":["import { Link, useNavigate } from \"react-router-dom\";\nimport { FcHome } from \"react-icons/fc\";\nimport \"./Profile.scss\";\nimport { useEffect, useState } from \"react\";\nimport { getAuth, updateProfile } from \"firebase/auth\";\nimport { toast } from \"react-toastify\";\nimport Notiflix from \"notiflix\";\nimport {\n  collection,\n  deleteDoc,\n  doc,\n  getDocs,\n  orderBy,\n  query,\n  updateDoc,\n  where,\n} from \"firebase/firestore\";\nimport { db } from \"../firebase\";\nimport ListingItem from \"../components/ListingItem\";\n\nexport default function Profile() {\n  const auth = getAuth();\n  const navigate = useNavigate();\n  const [changeDetail, setChangeDetail] = useState(false);\n  const [isLoading, setIsLoading] = useState(false);\n  const [listIsLoading, setListIsLoading] = useState(true);\n  const [listings, setListings] = useState(null);\n  const [formData, setFormData] = useState({\n    name: auth.currentUser.displayName,\n    email: auth.currentUser.email,\n  });\n\n  const { name, email } = formData;\n\n  function onLogout() {\n    auth.signOut();\n    navigate(\"/\");\n  }\n\n  function onChange(e) {\n    setFormData((prevState) => ({\n      ...prevState,\n      [e.target.id]: e.target.value,\n    }));\n  }\n\n  async function onSubmit() {\n    setIsLoading(true);\n    try {\n      if (auth.currentUser.displayName !== name) {\n        // update display name in firebase auth\n        await updateProfile(auth.currentUser, {\n          displayName: name,\n        });\n\n        // update name in firestore\n\n        const docRef = doc(db, \"users\", auth.currentUser.uid);\n        await updateDoc(docRef, {\n          name: name,\n        });\n      }\n      toast.success(\"Profile details updated\");\n      setIsLoading(false);\n    } catch (error) {\n      toast.error(\"Could not update the profile details\");\n    }\n  }\n\n  useEffect(() => {\n    async function fetchUserListings() {\n      const listingRef = collection(db, \"listings\");\n      const q = query(\n        listingRef,\n        where(\"userRef\", \"==\", auth.currentUser.uid),\n        orderBy(\"timestamp\", \"desc\")\n      );\n      const querySnap = await getDocs(q);\n      let listings = [];\n      querySnap.forEach((doc) => {\n        return listings.push({\n          id: doc.id,\n          data: doc.data(),\n        });\n      });\n      setListings(listings);\n      setListIsLoading(false);\n    }\n    fetchUserListings();\n  }, [auth.currentUser.uid]);\n\n  const confirmDelete = (listingId) => {\n    Notiflix.Confirm.show(\n      \"Delete Product!!!\",\n      \"You are about to delete this product\",\n      \"Delete\",\n      \"Cancel\",\n      function okCb() {\n        deleteListing(listingId);\n      },\n      function cancelCb() {\n        console.log(\"Delete Canceled\");\n      },\n      {\n        width: \"320px\",\n        borderRadius: \"3px\",\n        titleColor: \"red\",\n        okButtonBackground: \"red\",\n        cssAnimationStyle: \"zoom\",\n      }\n    );\n  };\n\n  async function deleteListing(listingId) {\n    await deleteDoc(doc(db, \"listings\", listingId));\n    const updatedListings = listings.filter(\n      (listing) => listing.id !== listingId\n    );\n    setListings(updatedListings);\n    toast.success(\"Successfully deleted the listing\");\n  }\n\n  function onEdit(listingId) {\n    navigate(`/edit-listing/${listingId}`);\n  }\n\n  return (\n    <>\n      <section className=\" profile\">\n        <h1 className=\" profile__header\">My Profile</h1>\n        <div className=\"profile__form-btn-wrap\">\n          <form className=\"profile__form\">\n            {/* Name Input */}\n\n            <input\n              type=\"text\"\n              id=\"name\"\n              value={name}\n              disabled={!changeDetail}\n              onChange={onChange}\n              className={`profile__form-input ${\n                changeDetail ? \"profile__form-input--modifier\" : \"\"\n              }`}\n            />\n\n            {/* Email Input */}\n\n            <input\n              type=\"email\"\n              id=\"email\"\n              disabled\n              className=\"profile__form-input\"\n              value={email}\n            />\n\n            <div className=\"profile__form-links\">\n              <p className=\"profile__form-name-change-link\">\n                Do you want to change your name?\n                <span\n                  onClick={() => {\n                    changeDetail && onSubmit();\n                    setChangeDetail((prevState) => !prevState);\n                  }}\n                  className=\"profile__form-name-change-link-name\"\n                >\n                  {!isLoading && changeDetail ? (\n                    \"Apply change\"\n                  ) : isLoading ? (\n                    <div className=\"loader--little\"></div>\n                  ) : (\n                    \"Edit\"\n                  )}\n                </span>\n              </p>\n              <p onClick={onLogout} className=\"profile__form-sign-out\">\n                Sign out\n              </p>\n            </div>\n          </form>\n          <button type=\"submit\" className=\"profile__home-sell-btn\">\n            <Link to=\"/create-listing\" className=\"profile__home-sell-btn-link\">\n              <FcHome className=\"profile__home-sell-btn-logo\" />\n              Sell or rent your home\n            </Link>\n          </button>\n        </div>\n      </section>\n      <div className=\"user-listings-section\">\n        {listIsLoading && <div className=\"loader\"></div>}\n        {!listIsLoading && listings.length > 0 && (\n          <>\n            <h2 className=\"user-listings-section__header\">My Listings</h2>\n            <ul className=\"user-listings-section__listing\">\n              {listings.map((listing) => (\n                <ListingItem\n                  key={listing.id}\n                  id={listing.id}\n                  listing={listing.data}\n                  onDelete={() => confirmDelete(listing.id)}\n                  onEdit={() => onEdit(listing.id)}\n                />\n              ))}\n            </ul>\n          </>\n        )}\n      </div>\n    </>\n  );\n}\n"],"names":["Profile","auth","getAuth","navigate","useNavigate","changeDetail","setChangeDetail","useState","isLoading","setIsLoading","listIsLoading","setListIsLoading","listings","setListings","formData","setFormData","name","currentUser","displayName","email","useEffect","async","listingRef","collection","db","q","query","where","uid","orderBy","querySnap","getDocs","forEach","doc","push","id","data","fetchUserListings","confirmDelete","listingId","Notiflix","deleteDoc","updatedListings","filter","listing","toast","deleteListing","console","log","width","borderRadius","titleColor","okButtonBackground","cssAnimationStyle","_jsxs","_Fragment","children","className","_jsx","type","value","disabled","onChange","e","prevState","_objectSpread","target","concat","onClick","updateProfile","docRef","updateDoc","error","onSubmit","signOut","Link","to","FcHome","length","map","ListingItem","onDelete","onEdit"],"sourceRoot":""}